# üèóÔ∏è DWH Project Analyzer

–ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –±–∞–∑–µ CrewAI –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ Data Warehouse (dbt, SQL, ETL).

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç **Code Review** - –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ SQL/dbt –∫–æ–¥–∞, –ø–æ–∏—Å–∫ –±–∞–≥–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- üìù **Documentation** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è –º–æ–¥–µ–ª–µ–π, —Å–æ–∑–¥–∞–Ω–∏–µ schema.yml
- üèóÔ∏è **Architecture** - –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã DWH, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ data lineage
- üí¨ **Q&A** - –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –ø—Ä–æ–µ–∫—Ç–µ —Å –ø–æ–∏—Å–∫–æ–º –ø–æ –∫–æ–¥—É

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ú–æ–¥–µ–ª–∏ |
|-----------|--------|
| OpenAI | gpt-4o, gpt-4-turbo, gpt-3.5-turbo |
| Anthropic | claude-3.5-sonnet, claude-3-opus |
| Ollama | llama3, mistral, codellama |
| OpenRouter | –õ—é–±—ã–µ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ API |
| z.ai | –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–æ–¥–µ–ª–∏ |

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your-repo/crewai_dwh.git
cd crewai_dwh

# –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à–∏ API –∫–ª—é—á–∏

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ projects.yaml –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤

–ü—Ä–æ–µ–∫—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `projects.yaml`:

```yaml
# –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
projects:
  - name: airflow_dbt          # –ò–º—è –ø—Ä–æ–µ–∫—Ç–∞ (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ)
    path: /path/to/airflow_dbt  # –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
  - name: my_dbt_project
    path: /path/to/my_dbt_project
```

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ.

## –ó–∞–ø—É—Å–∫

```bash
streamlit run app.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8501`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
crewai_dwh/
‚îú‚îÄ‚îÄ app.py                      # Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ settings.py             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ .env
‚îÇ   ‚îî‚îÄ‚îÄ llm_config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ schemas/                    # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.py               # –°—Ö–µ–º—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ tools.py                # –°—Ö–µ–º—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ messages.py             # –°—Ö–µ–º—ã —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ dwh.py                  # DWH-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ crew/
‚îÇ   ‚îî‚îÄ‚îÄ project_crew.py         # ProjectAnalyzerCrew
‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îú‚îÄ‚îÄ code_reviewer.py        # Code Reviewer Agent
‚îÇ   ‚îú‚îÄ‚îÄ documentation.py        # Documentation Agent
‚îÇ   ‚îú‚îÄ‚îÄ architecture.py         # Architecture Agent
‚îÇ   ‚îî‚îÄ‚îÄ qa_expert.py            # Q&A Expert Agent
‚îú‚îÄ‚îÄ tools/
‚îÇ   ‚îú‚îÄ‚îÄ file/                   # –§–∞–π–ª–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ read_file.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ list_directory.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search_code.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project_structure.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ write_file.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ edit_file.py
‚îÇ   ‚îú‚îÄ‚îÄ dwh/                    # DWH –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sql_analyze.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dbt_parser.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lineage_tracer.py
‚îÇ   ‚îî‚îÄ‚îÄ web_search.py
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ sandbox.py              # Sandbox –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ env.example
‚îú‚îÄ‚îÄ projects.yaml               # –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
‚îî‚îÄ‚îÄ README.md
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

1. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É DWH –ø—Ä–æ–µ–∫—Ç—É –≤ sidebar
2. –í—ã–±–µ—Ä–∏—Ç–µ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏ –º–æ–¥–µ–ª—å
3. –ù–∞–∂–º–∏—Ç–µ "Initialize Crew"

### 2. –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

#### üí¨ Ask Question (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
–ó–∞–¥–∞–≤–∞–π—Ç–µ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ –ø—Ä–æ–µ–∫—Ç–µ:
- "–ö–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ –µ—Å—Ç—å –≤ –ø–∞–ø–∫–µ staging?"
- "–û—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã orders_mart?"
- "–û–±—ä—è—Å–Ω–∏ —á—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç SQL –∑–∞–ø—Ä–æ—Å"

#### üîç Code Review
–ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞:
- "–ü—Ä–æ–≤–µ—Ä—å –º–æ–¥–µ–ª–∏ –≤ –ø–∞–ø–∫–µ marts –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é"
- "–ù–∞–π–¥–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SELECT *"
- "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π SQL —Ñ–∞–π–ª orders.sql"

#### üìù Generate Docs
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
- "–°–æ–∑–¥–∞–π schema.yml –¥–ª—è –º–æ–¥–µ–ª–∏ stg_orders"
- "–ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –≤—Å–µ –º–æ–¥–µ–ª–∏ –≤ –ø–∞–ø–∫–µ staging"
- "–î–æ–±–∞–≤—å –æ–ø–∏—Å–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã dim_customers"

#### üèóÔ∏è Architecture
–ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
- "–ü–æ–∫–∞–∂–∏ lineage –¥–ª—è –º–æ–¥–µ–ª–∏ orders_mart"
- "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –æ–±—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞"
- "–ù–∞–π–¥–∏ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–≥–µ–Ω—Ç–æ–≤

### File Tools
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|
| `read_file` | –ß—Ç–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ |
| `list_directory` | –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ |
| `search_code` | –ü–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É (regex) |
| `get_project_structure` | –î–µ—Ä–µ–≤–æ –ø—Ä–æ–µ–∫—Ç–∞ |
| `write_file` | –ó–∞–ø–∏—Å—å —Ñ–∞–π–ª–∞ |
| `edit_file` | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ |

### DWH Tools
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|
| `analyze_sql` | –ê–Ω–∞–ª–∏–∑ SQL –∑–∞–ø—Ä–æ—Å–∞ |
| `parse_dbt_model` | –ü–∞—Ä—Å–∏–Ω–≥ dbt –º–æ–¥–µ–ª–∏ |
| `trace_lineage` | –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ data lineage |

### Other
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|
| `web_search` | –ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ |

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π (sandbox)
- –ó–∞—â–∏—Ç–∞ –æ—Ç path traversal –∞—Ç–∞–∫
- API –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ .env —Ñ–∞–π–ª–µ

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

```
# –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞
"–ù–∞–π–¥–∏ –≤—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ WHERE —É—Å–ª–æ–≤–∏—è"
"–ü—Ä–æ–≤–µ—Ä—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ dbt best practices"

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
"–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π README –¥–ª—è —ç—Ç–æ–≥–æ dbt –ø—Ä–æ–µ–∫—Ç–∞"
"–°–æ–∑–¥–∞–π –æ–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö"

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
"–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ staging –∏ marts"
"–û–ø—Ä–µ–¥–µ–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å –¥–∞–Ω–Ω—ã—Ö –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–æ –æ—Ç—á–µ—Ç–∞"

# Q&A
"–ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∞ revenue –≤ mart_sales?"
"–ö–∞–∫–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –º–æ–¥–µ–ª–∏ dim_products?"
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

1. –°–æ–∑–¥–∞–π—Ç–µ Pydantic —Å—Ö–µ–º—ã –≤ `schemas/`
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–∞—Å–ª–µ–¥—É—è –æ—Ç `BaseTool`
3. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ –Ω—É–∂–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∞–≥–µ–Ω—Ç–∞ –≤ `agents/`
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ä–æ–ª—å, —Ü–µ–ª—å –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
3. –î–æ–±–∞–≤—å—Ç–µ –∞–≥–µ–Ω—Ç–∞ –≤ `ProjectAnalyzerCrew`

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
